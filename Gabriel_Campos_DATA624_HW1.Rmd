---
title: 'DATA 624: PREDICTIVE ANALYTICS'
author: "Gabriel Campos"
date: "Last edited `r format(Sys.time(), '%B %d, %Y')`"
output:
  pdf_document:
    latex_engine: xelatex
  geometry: left=0.5cm,right=0.5cm,top=1cm,bottom=2cm
  html_document:
    df_print: paged
  html_notebook: default
urlcolor: blue
---

```{r, message=FALSE, warning=FALSE}
library('fpp3')
library('tsibble')
library('ggplot2')
library('USgas')
```


# INSTRUCTIONS

Please submit exercises 2.1, 2.2, 2.3, 2.4, 2.5 and 2.8 from the Hyndman online Forecasting book.  Please submit both your Rpubs link as well as attach the .pdf file with your code.

#2.1

1.  Explore the following four time series: `Bricks` from `aus_production`, `Lynx` from `pelt`, `Close` from `gafa_stock`, `Demand` from `vic_elec`.

    i. Use ? (or help()) to find out about the data in each series.
    ii. What is the time interval of each series?
    iii. Use autoplot() to produce a time plot of each series.
    iv. For the last plot, modify the axis labels and title.
    
    
```{r}
data("aus_production")
data("pelt")
data("gafa_stock")
data("vic_elec")
```

## Bricks

### i

*Details*
Quarterly estimates of selected indicators of manufacturing production in Australia.

*Bricks:*	Clay brick production in millions of bricks.

### ii

Quarterly

```{r}
aus_production%>%
  select(Bricks)
```
### iii

```{r}
autoplot(aus_production,Bricks) +
  labs(title = "Time Plot of Bricks Series",
       x = "Quarterly",
       y = "Bricks Production count")
```
## Lynx

### i

pelt is an annual tsibble with two values:

Hare:	The number of Snowshoe Hare pelts traded.
Lynx:	The number of Canadian Lynx pelts traded.

### ii

```{r}
pelt %>%
  select(Lynx)
```

### iii

```{r}

autoplot(pelt,Lynx) +
  labs(title = "Time Plot of lynx Series (1845 to1935)",
       x = "Annually",
       y = "Lynx pelts traded Count")

```

## Close

### i

Details
gafa_stock is a tsibble containing data on irregular trading days:

Open:	The opening price for the stock.
High:	The stock's highest trading price.
Low:	The stock's lowest trading price.
Close:	The closing price for the stock.
Adj_Close:	The adjusted closing price for the stock.
Volume:	The amount of stock traded.
Each stock is uniquely identified by one key:

Symbol:	The ticker symbol for the stock.

### ii

```{r}
gafa_stock%>%
  select(Close)
```

The `gafa_stock` is daily data

### iii

```{r}

autoplot(gafa_stock,Close) +
  labs(title = "Time Plot of Closing Stock Price ('Yahoo Finance' 2014-2018)",
       x = "Daily",
       y = "Closing price")

```

## Demand

### i

**Description***

`vic_elec` is a half-hourly `tsibble` with three values:

Demand:	Total electricity demand in MWh.
Temperature:	Temperature of Melbourne (BOM site 086071).
Holiday:	Indicator for if that day is a public holiday.

### ii

```{r}

vic_elec %>%
  select(Demand)

```


### iii & vi

```{r}
autoplot(vic_elec,Demand) +
  labs(title = "Time Plot of Electricity Demand Victoria, Australia",
       x = "Time(30min Intervals",
       y = "Demand in MWh")
```

# 2.2

Use filter() to find what days corresponded to the peak closing price for each of the four stocks in gafa_stock.


```{r}
colnames(gafa_stock)
```

```{r}

 gafa_stock %>%
  group_by(Symbol) %>%
  filter(Close == max(Close))

```


# 2.3

